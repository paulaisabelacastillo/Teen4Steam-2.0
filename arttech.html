<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Art & Tech Studio - Galer√≠a Creativa</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      text-align: center;
      background: linear-gradient(to right, #fdf4ff, #e0c3fc);
      margin: 0;
      padding: 20px;
    }

    h1 {
      font-size: 2em;
      margin-bottom: 10px;
      color: #6a1b9a;
    }

    #mission, #timer {
      margin-bottom: 10px;
      font-size: 1.2em;
      font-weight: bold;
      color: #4a148c;
    }

    #color-picker {
      margin: 10px 0;
    }

    #drawing-area {
      background-color: #fff;
      border: 3px dashed #ba68c8;
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      display: block;
      margin: 20px auto;
      touch-action: none;
    }

    button {
      background-color: #ba68c8;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 1em;
      border-radius: 25px;
      cursor: pointer;
      margin: 8px;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #9c27b0;
    }

    #gallery {
      display: none;
      margin-top: 30px;
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    .artwork {
      width: 30%;
      margin: 10px;
      border: 2px solid #ba68c8;
      border-radius: 10px;
    }

    .gallery-title {
      font-size: 1.5em;
      color: #4a148c;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

  <h1>üé® Art & Tech Studio</h1>

  <p id="mission">¬°Haz clic en "Nueva Misi√≥n" para comenzar!</p>
  <p id="timer">Tiempo restante: 5:00</p>

  <input type="color" id="color-picker" value="#ff7eb9">
  <br>

  <canvas id="drawing-area" width="350" height="350"></canvas>
  <br>

  <button onclick="newMission()">Nueva Misi√≥n</button>
  <button onclick="saveDrawing()">Guardar mi obra</button>
  <button onclick="endGame()">Finalizar manualmente</button>

  <div id="gallery">
    <h2 class="gallery-title">¬°Felicidades, artista! Has completado tu galer√≠a creativa. üñºÔ∏è</h2>
    <div id="artworks"></div>
  </div>

  <script>
    const canvas = document.getElementById('drawing-area');
    const ctx = canvas.getContext('2d');
    const colorPicker = document.getElementById('color-picker');
    const missionText = document.getElementById('mission');
    const timerText = document.getElementById('timer');
    const gallery = document.getElementById('gallery');
    const artworksDiv = document.getElementById('artworks');

    const missions = [
      "üéØ Dise√±a el logo de tu nave espacial.",
      "üéØ Crea un p√≥ster para un invento del futuro.",
      "üéØ Dibuja tu robot ayudante ideal.",
      "üéØ Dise√±a un traje espacial art√≠stico.",
      "üéØ Crea una ciudad flotante sobre el mar.",
      "üéØ Dibuja un gadget para salvar el planeta.",
      "üéØ Dise√±a tu m√°quina de sue√±os.",
      "üéØ Imagina tu parque de diversiones STEAM."
    ];

    let painting = false;
    let drawings = [];
    let timer;
    let timeLeft = 300; // 5 minutos = 300 segundos

    function startPosition(e) {
      painting = true;
      draw(e);
    }

    function endPosition() {
      painting = false;
      ctx.beginPath();
    }

    function draw(e) {
      if (!painting) return;

      const rect = canvas.getBoundingClientRect();
      const x = (e.clientX || e.touches[0].clientX) - rect.left;
      const y = (e.clientY || e.touches[0].clientY) - rect.top;

      ctx.lineWidth = 5;
      ctx.lineCap = 'round';
      ctx.strokeStyle = colorPicker.value;

      ctx.lineTo(x, y);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(x, y);
    }

    function clearCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    function newMission() {
      if (drawings.length >= 3) {
        endGame();
        return;
      }
      const randomIndex = Math.floor(Math.random() * missions.length);
      missionText.textContent = missions[randomIndex];
      clearCanvas();
    }

    function saveDrawing() {
      if (drawings.length >= 3) {
        alert("Ya has guardado las 3 obras. Finaliza el juego.");
        return;
      }
      const dataURL = canvas.toDataURL('image/png');
      drawings.push(dataURL);
      clearCanvas();
      if (drawings.length >= 3) {
        endGame();
      } else {
        alert(`¬°Obra guardada! Ahora crea tu obra n√∫mero ${drawings.length + 1}.`);
      }
    }

    function startTimer() {
      timer = setInterval(() => {
        timeLeft--;
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        timerText.textContent = `Tiempo restante: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        if (timeLeft <= 0) {
          clearInterval(timer);
          endGame();
        }
      }, 1000);
    }

    function endGame() {
      clearInterval(timer);
      document.getElementById('drawing-area').style.display = 'none';
      document.getElementById('color-picker').style.display = 'none';
      document.querySelectorAll('button').forEach(btn => btn.style.display = 'none');
      document.getElementById('mission').style.display = 'none';
      document.getElementById('timer').style.display = 'none';
      gallery.style.display = 'block';

      drawings.forEach(dataURL => {
        const img = document.createElement('img');
        img.src = dataURL;
        img.className = 'artwork';
        artworksDiv.appendChild(img);
      });
    }

    // Eventos
    canvas.addEventListener('mousedown', startPosition);
    canvas.addEventListener('mouseup', endPosition);
    canvas.addEventListener('mousemove', draw);

    canvas.addEventListener('touchstart', startPosition);
    canvas.addEventListener('touchend', endPosition);
    canvas.addEventListener('touchmove', draw);

    // Iniciar el cron√≥metro
    startTimer();
  </script>

</body>
</html>
